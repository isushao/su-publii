<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Mongo学习路程 - 𝓼𝓾.𝓼𝓱𝓪𝓸.blog</title><meta name="description" content="MongoDB是一个开源的，跨平台的分布式文档数据库。MongoDB由MongoDB Inc.开发。并被归类为NoSQL数据库。"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://isushao.github.io/su-publii/mongoxue-xi-xin-lu.html"><link rel="alternate" type="application/atom+xml" href="https://isushao.github.io/su-publii/feed.xml"><link rel="alternate" type="application/json" href="https://isushao.github.io/su-publii/feed.json"><link rel="stylesheet" href="https://isushao.github.io/su-publii/assets/css/style.css?v=4128e7e1a641a287245dedc222b18c79"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://isushao.github.io/su-publii/mongoxue-xi-xin-lu.html"},"headline":"Mongo学习路程","datePublished":"2022-08-04T11:19","dateModified":"2022-08-09T16:02","description":"MongoDB是一个开源的，跨平台的分布式文档数据库。MongoDB由MongoDB Inc.开发。并被归类为NoSQL数据库。","author":{"@type":"Person","name":"Roc Su","url":"https://isushao.github.io/su-publii/authors/sushaopeng/"},"publisher":{"@type":"Organization","name":"Roc Su"}}</script></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://isushao.github.io/su-publii/">𝓼𝓾.𝓼𝓱𝓪𝓸.blog</a></header><main><article class="post"><div class="hero"><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2022-08-04T11:19">八月 4, 2022</time></div><h1>Mongo学习路程</h1><div class="post__meta post__meta--author"><a href="https://isushao.github.io/su-publii/authors/sushaopeng/" class="feed__author">Roc Su</a></div></div></header></div><div class="wrapper post__entry"><h3></h3><h1></h1><p>MongoDB是一个开源的，跨平台的分布式文档数据库。MongoDB由<a href="https://www.mongodb.com/company" target="_blank" rel="noreferrer noopener" _istranslated="1">MongoDB Inc.</a>开发。并被归类为NoSQL数据库。</p><h1></h1><h1>MongoDB简介</h1><h2>1）易于使用</h2><p>MongoDB是一个面向文档的数据库。它使用文档的概念来存储数据，这比关系数据库管理系统（RDBMS）中的行概念更灵活。</p><p>文档允许您用单个记录表示复杂的层次结构关系。</p><p>MongoDB不需要预定义的架构，允许您更快地在文档中添加或删除字段。</p><h2>2） 设计用于横向扩展</h2><p>当数据库增长时，您将面临如何扩展它的挑战。有两种常见的方法：</p><ul><li>向上扩展 – 将当前服务器升级到具有更多资源（CPU，RAM等）的更大服务器。但是，获得更大的服务器意味着增加更多的成本。</li><li>横向扩展 – 购买其他服务器并将其添加到群集。这比纵向扩展更便宜，更具可扩展性。缺点是管理多台服务器比管理大型服务器需要更多的精力。</li></ul><p>MongoDB旨在向外扩展。</p><p>MongoDB允许您将数据拆分到许多服务器之间。它还会自动管理群集中的负载平衡、重新分发数据以及将更新路由到正确的服务器。</p><p>下图说明了MongoDB如何在多个服务器上使用分片进行横向扩展：</p><figure class="wp-block-image size-large"><figure class="wp-image-111"><img loading="lazy" src="https://www.mongodbtutorial.org/wp-content/uploads/2020/08/what-is-mongodb-scale-out.png" data-is-external-image="true" sizes="(max-width: 682px) 100vw, 682px" srcset="https://www.mongodbtutorial.org/wp-content/uploads/2020/08/what-is-mongodb-scale-out.png 682w, https://www.mongodbtutorial.org/wp-content/uploads/2020/08/what-is-mongodb-scale-out-300x152.png 300w" alt="" width="682" height="346"></figure></figure><h2>3）丰富的功能</h2><p>像任何数据库系统一样，MongoDB允许您插入，更新和删除以及选择数据。此外，它还支持其他功能，包括：</p><ul><li>索引</li><li>集合体</li><li>指定集合和索引类型</li><li>文件存储</li></ul><h2>4） 高性能</h2><p>MongoDB旨在从架构和功能的角度保持高性能。</p><p>MongoDB的理念是创建一个可扩展，灵活和快速的全功能数据库。</p><h1>MongoDB vs. MySQL</h1><p>MySQL使用结构化查询语言来访问存储的数据。在这种格式中，架构用于创建数据库结构，利用表作为标准化数据类型的一种方式，以便值可搜索并可以正确查询。MySQL是一个成熟的解决方案，可用于各种情况，包括网站数据库，应用程序和商业产品管理。</p><p>由于其刚性，当数据完整性和隔离至关重要时，例如在管理事务数据时，MySQL比MongoDB更可取。但是MongoDB限制较少的格式和更高的性能使其成为更好的选择，特别是当可用性和速度是主要问题时。</p><h1>MongoDB vs. Redis</h1><p>Redis是一个内存数据库存储，MongoDB被称为磁盘上的文档存储。尽管这两种解决方案都是为不同的目的而构建的，但它们通常一起使用以最大限度地提高NoSQL数据库的速度和效率。由于其缓存能力，Redis可以非常快速地找到所需的数据，作为摄取缓冲区，使MongoDB更加高效，并能够近乎实时地管理更大频率的文档更新。凭借MongoDB存储大量数据的能力以及Redis处理数据的能力，该配对为各种用例提供了强大的数据库管理解决方案。</p><p> </p><h1>MongoDB数据格式</h1><p>在MongoDB中，通常使用到JSON和BSON数据格式。</p><h2 id="json">JSON</h2><p>JSON 代表 JavaScript Object Notation。JSON 语法基于 JavaScript ECMA-262 第 3 版的子集。</p><p>JSON 文档是结构化格式的字段和值的集合。例如：</p><p><code>{<br>   "first_name": "John",<br>   "last_name": "Doe",<br>   "age": 22,<br>   "skills": ["Programming","Databases", "API"]<br>}</code></p><h2 id="bson">BSON</h2><p>BSON代表二进制JSON，它是类似JSON的文档的二进制编码序列化。</p><h2 id="documents">文档</h2><p>MongoDB将数据记录存储为BSON文档，这些文档简称为文档。</p><div class="wp-block-image"><figure class="aligncenter size-large"><figure class="wp-image-241"><img loading="lazy" src="https://www.mongodbtutorial.org/wp-content/uploads/2020/08/MongoDB-Document.png" data-is-external-image="true" alt="" width="298" height="199"></figure></figure></div><p>文档是具有以下结构的一组字段和值对：</p><div><code>{<br>   field_name1: value1,<br>   field_name2: value2,<br>   field_name3: value3,<br>   ...<br>}</code></div><p>在此语法中，字段名称是字符串，值可以是数字、字符串、对象、数组等。例如：</p><div><code>{<br>    _id: ObjectId("5f339953491024badf1138ec"),<br>    title: "MongoDB Tutorial",<br>    isbn: "978-4-7766-7944-8",<br>    published_date: new Date('June 01, 2020'),<br>    author: { first_name: "John"<br>, last_name: "Doe"}<br>}</code></div><p>本文档具有以下字段和值对：</p><ul><li><code>_id</code>持有<code>ObjectId</code></li><li><code>title</code>保存一个字符串。</li><li><code>isbn</code>保存一个字符串。</li><li><code>published_date</code>保存该类型的值。<code>Date</code></li><li><code>author</code>包含包含两个字段和 的嵌入文档。<code>first_name</code><code>last_name</code></li></ul><p>如果您熟悉关系数据库管理系统（RDBMS），您会发现文档类似于表中的行，但它更具表现力。</p><p>字段名称具有以下限制：</p><ul><li>MongoDB保留该字段并使用它来唯一标识文档。<code>_id</code></li><li>字段名称不能包含空字符。</li><li>顶级字段名称不能以美元符号 （） 字符开头。<code>$</code></li></ul><h2 id="collections">集合</h2><p>MongoDB将文档存储在集合中。集合是一组文档。</p><div class="wp-block-image"><figure class="aligncenter size-large"><figure class="wp-image-240"><img loading="lazy" src="https://www.mongodbtutorial.org/wp-content/uploads/2020/08/MongoDB-Collection.png" data-is-external-image="true" sizes="(max-width: 367px) 100vw, 367px" srcset="https://www.mongodbtutorial.org/wp-content/uploads/2020/08/MongoDB-Collection.png 367w, https://www.mongodbtutorial.org/wp-content/uploads/2020/08/MongoDB-Collection-300x190.png 300w" alt="" width="367" height="232" loading="lazy"></figure></figure></div><p>集合类似于 RDBMS 中的表。</p><figure class="wp-block-table is-style-regular"><table><tbody><tr><td><strong>MongoDB</strong></td><td><strong>RDBMS</strong></td></tr><tr><td>文档</td><td>行</td></tr><tr><td>集合</td><td>表</td></tr></tbody></table></figure><p>与具有固定架构的表不同，集合具有动态架构。</p><p>这意味着集合可能包含具有任意数量不同“形状”的文档。例如，可以将以下文档存储在同一集合中：</p><p><code>{<br>    title: "MongoDB Tutorial",<br>    published_date: new Date('June 01, 2020')<br>}<br><br>{<br>    title: "MongoDB Basics",<br>    published_date: new Date('Jan 01, 2021'),<br>    isbn": "978-4-7766-7944-8"<br>}</code></p><p>请注意，第二个文档比第一个文档多一个字段。从理论上讲，您可以为每个文档设置完全不同的字段。</p><p>集合具有名称，例如 .集合名称不能：<code>books</code></p><ul><li>包含美元符号 （<code>$</code>)</li><li>包含空字符 （）。<code>\0</code></li><li>为空字符串。</li><li>从系统开始，因为MongoDB为内部集合名称保留了system*。</li></ul><h2 id="databases">数据库</h2><p>MongoDB将集合存储到数据库中。MongoDB的单个实例可以托管多个数据库。</p><div class="wp-block-image"><figure class="aligncenter size-large"><figure class="wp-image-239"><img loading="lazy" src="https://www.mongodbtutorial.org/wp-content/uploads/2020/08/MongoDB-Database-1.png" data-is-external-image="true" sizes="(max-width: 308px) 100vw, 308px" srcset="https://www.mongodbtutorial.org/wp-content/uploads/2020/08/MongoDB-Database-1.png 308w, https://www.mongodbtutorial.org/wp-content/uploads/2020/08/MongoDB-Database-1-300x203.png 300w" alt="" width="308" height="208" loading="lazy"></figure></figure></div><p>数据库可以通过名称引用，例如 。数据库名称不能：<code>bookdb</code></p><ul><li>为空字符串 （）。<code>""</code></li><li>包含以下任意字符：<em>/</em>、<em>\</em>、<em>.</em>、<em>“</em>、<em>*</em>、<em>&lt;</em>、<em>&gt;</em>、<em>：</em>、<em>|</em>、<em>？</em>、<em>$</em>、（单个空格）或 <em>\0</em>（字符）。<code>null</code></li><li>超过最大大小 64 字节。</li></ul><p>MongoDB 还有一些保留的数据库名称，例如 、、，并且不能用于创建新数据库。<code>admin</code> <code>local</code> <code>config</code></p><h3 id="namespace">Namespace</h3><p>命名空间是数据库名称与该数据库中的集合的串联。命名空间允许您完全限定集合。</p><p>例如，如果集合名称为 ，而数据库名称为 ，则集合的命名空间将为 .<code>books</code> <code>bookdb</code> <code>books</code> <code>bookdb.books</code></p><h2 id="summary">总结</h2><ul><li>MongoDB将数据记录存储为BSON文档。文档是一组字段和值对。</li><li>MongoDB将文档存储在集合中，将集合存储在数据库中。</li><li>命名空间是数据库名称和集合名称 （） 的串联，用于完全限定集合。<code>database_name.collection_name</code></li></ul><h1>实践</h1><h2>安装</h2><ol><li>按照官方给出的不同环境的安装说明，进行选择安装。下载地址：<a href="https://www.mongodb.com/try/download/community" title="mongodb下载" target="_blank" rel="noopener noreferrer">https://www.mongodb.com/try/download/community</a></li><li>安装mongoshell。下载地址：<a href="https://docs.mongodb.com/mongodb-shell" title="mongodb-shell 下载" target="_blank" rel="noopener noreferrer">https://docs.mongodb.com/mongodb-shell</a></li><li>设置auth</li></ol><p class="md-end-block md-p"><span class="md-plain">创建用户</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash" spellcheck="false"><span role="presentation">xxx\root&gt; mongsh</span><br><span role="presentation">test&gt; use admin</span><br><span role="presentation">amdin&gt; db.createUser(</span><br><span role="presentation">{</span><br><span role="presentation">user: <span class="cm-string">"admin"</span>,</span><br><span role="presentation">pwd: passwordPrompt(),</span><br><span role="presentation">roles: [ { role: <span class="cm-string">"userAdminAnyDatabase"</span>, db: <span class="cm-string">"admin"</span> } ]</span><br><span role="presentation">}</span><br><span role="presentation">)</span></pre><p><span class="md-plain">修改mongodb配置如下：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" lang="yaml" spellcheck="false"><span role="presentation"><span class="cm-atom">security</span><span class="cm-meta">:</span></span><br><span role="presentation"><span class="cm-atom">  authorization</span><span class="cm-meta">: </span>enabled</span></pre><p class="md-end-block md-p"><span class="md-plain">再次访问</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash" spellcheck="false"><span role="presentation">xxx\root&gt; mongsh</span><br><span role="presentation">test&gt; use admin</span><br><span role="presentation">admin&gt; db.auth(<span class="cm-string">"admin"</span>,passwordPrompt())</span></pre><h2>CRUD</h2><h3>insertOne</h3><pre>db.collection.insertOne(<br>   &lt;document&gt;,<br>   { writeConcern: &lt;document&gt;}<br>)</pre><p>参数：</p><ul><li><code>document</code>是要插入的文档，必须。</li><li><code>writeConcern</code>是一个可选参数，描述MongoDB写关注点，用于将操作插入到独立的 MongoDB 服务器或共享集群。</li></ul><p>示例：</p><pre>db.books.insertOne({ <br>    title: 'MongoDB insertOne',<br>    isbn: '0-7617-6154-3'<br>});</pre><p>返回：</p><pre>{<br>        "acknowledged" : true,<br>        "insertedId" : ObjectId("5f31cf00902f22de3464ddc4")<br>}</pre><ul><li><code>acknowledged</code>是一个布尔值。如果执行插入时带有写入关注点，则将其设置为 true;如果禁用了写入关注点，则将其设置为 false。</li><li><code>insertedId</code>存储插入文档的字段值。<code>_id</code></li></ul><h3>insertMany</h3><pre>db.collection.insertMany(<br>   [document1, document2, ...],<br>   {<br>      writeConcern: &lt;document&gt;,<br>      ordered: &lt;boolean&gt;<br>   }<br>)</pre><p>第一个参数是要插入到集合中的文档数组。</p><p>第二个参数包含两个可选字段-值对的文档：</p><pre>{<br>   writeConcern: &lt;document&gt;,<br>   ordered: &lt;boolean&gt;<br>}</pre><p>同上writeConcern指写关注点，省略后会插入默认的写入关注点。</p><p>orderd用于确认 MongoDB 是否应该执行有序或无序插入。</p><p>当<code>ordered</code>设置为 时<code>true</code>，该<code>insertMany()</code>方法按顺序插入文档。这也是默认选项。</p><p>如果<code>ordered</code>设置为<code>false</code>，MongoDB 可能会在插入之前重新排序文档以提高性能。</p><p>示例：</p><pre>db.products.insertMany([<br>    { "_id" : 1, "name" : "xPhone", "price" : 799, "releaseDate": ISODate("2011-05-14"), "spec" : { "ram" : 4, "screen" : 6.5, "cpu" : 2.66 },"color":["white","black"],"storage":[64,128,256]},<br>    { "_id" : 2, "name" : "xTablet", "price" : 899, "releaseDate": ISODate("2011-09-01") , "spec" : { "ram" : 16, "screen" : 9.5, "cpu" : 3.66 },"color":["white","black","purple"],"storage":[128,256,512]},<br>    { "_id" : 3, "name" : "SmartTablet", "price" : 899, "releaseDate": ISODate("2015-01-14"), "spec" : { "ram" : 12, "screen" : 9.7, "cpu" : 3.66 },"color":["blue"],"storage":[16,64,128]},<br>    { "_id" : 4, "name" : "SmartPad", "price" : 699, "releaseDate": ISODate("2020-05-14"),"spec" : { "ram" : 8, "screen" : 9.7, "cpu" : 1.66 },"color":["white","orange","gold","gray"],"storage":[128,256,1024]},<br>    { "_id" : 5, "name" : "SmartPhone", "price" : 599,"releaseDate": ISODate("2022-09-14"), "spec" : { "ram" : 4, "screen" : 5.7, "cpu" : 1.66 },"color":["white","orange","gold","gray"],"storage":[128,256]}<br> ])</pre><h3>findOne</h3><pre>db.collection.findOne(query, projection)</pre><p>两个可选参数：<code>query</code>和<code>projection</code>.</p><ul><li><code>query</code>是一个指定选择标准的文档。</li><li><code>projection</code>是一个文档，它指定要返回的匹配文档中的字段。</li></ul><p>示例1：默认查询第一条</p><pre>db.products.findOne()</pre><p>返回：</p><pre>{<br>  _id: 1,<br>  name: 'xPhone',<br>  price: 799,<br>  releaseDate: ISODate("2011-05-14T00:00:00.000Z"),<br>  spec: { ram: 4, screen: 6.5, cpu: 2.66 },<br>  color: [ 'white', 'black' ],<br>  storage: [ 64, 128, 256 ]<br>}</pre><p>示例2：选择一些字段查询</p><pre>db.products.findOne({_id: 5}, {name: 1, id:0})</pre><p>返回：</p><pre>{"name" : "SmartPhone" }</pre></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on 八月 9, 2022</p><div class="post__share"></div><div class="post__bio bio"><div class="bio__info"><h3 class="bio__name"><a href="https://isushao.github.io/su-publii/authors/sushaopeng/" rel="author">Roc Su</a></h3><p>分享总是美好的</p></div></div></footer></article></main><footer class="footer"><div class="footer__copyright">Powered by Publii</div><button onclick="backToTopFunction()" id="backToTop" class="footer__bttop" aria-label="Back to top" title="Back to top"><svg><use xlink:href="https://isushao.github.io/su-publii/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script defer="defer" src="https://isushao.github.io/su-publii/assets/js/scripts.min.js?v=f47c11534595205f20935f0db2a62a85"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');

        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script></body></html>